{"version":3,"sources":["parcels.js"],"names":["router","express","Router","post","req","res","priceNormal","priceExpress","price","user","User","filter","customer","userId","body","calculatePrice","pricePerOneWeight","weight","height","length","From","services","pId","Parcels","parcelWith","parcelId","status","push","console","log","json","success","message","Number","toFixed","get","parcelDeliveries","parcels","parcelDelivery","parcel","params","put","find","item","parseInt","index","indexOf","send"],"mappings":"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","file":"parcels.js","sourceRoot":"/home/emmanuel/Projects/SelfProject/sendit/src/routes","sourcesContent":["import express from 'express';\nimport Parcels from '../data/parcels';\nimport User from '../data/users';\n\nconst router = express.Router();\n\n// Create parcel\nrouter.post('/', (req, res) => {\n  // const { userId } = req.body;\n  const priceNormal = 20; // Price in $\n  const priceExpress = 70;\n  // Parcel price in $\n  let price;\n\n  const user = User.filter(customer => customer.userId === req.body.userId)[0];\n\n  const calculatePrice = pricePerOneWeight => (\n    (pricePerOneWeight * req.body.weight * req.body.height * req.body.length)\n  );\n  if (user) {\n    // Price per Service on Normal\n    // Price per Service on Express\n    price = req.body.From === req.body.services\n      ? calculatePrice(priceNormal)\n      : calculatePrice(priceExpress);\n    // Parcel Id\n    const pId = Parcels.length + 1;\n    const parcelWith = { ...req.body };\n    parcelWith.parcelId = pId;\n    parcelWith.status = 'Pending';\n\n    // Save parcel\n    Parcels.push(parcelWith);\n\n    console.log(Parcels);\n    return res.status(201).json({\n      success: true,\n      message: 'Parcel created successfully',\n      parcelId: pId,\n      price: Number(price.toFixed(2)),\n    });\n  }\n\n  return res.status(404).json({\n    success: false,\n    message: 'User not Exist',\n  });\n});\n\n// Get all parcels\nrouter.get('/', (req, res) => {\n  const parcelDeliveries = [...Parcels];\n  res.status(200).json({\n    success: true,\n    message: 'Parcels retrieved successfully',\n    parcels: parcelDeliveries,\n  });\n});\n\n// Get a specific parcels\nrouter.get('/:parcelId', (req, res) => {\n  const parcelDelivery = Parcels.filter(\n    parcel => parcel.parcel.parcelId === Number(req.params.parcelId),\n  );\n\n  if (parcelDelivery.length > 0) {\n    return res.status(200).json({\n      success: true,\n      message: `Parcel of id ${req.params.parcelId} retrieved successfully`,\n      parcel: parcelDelivery[0],\n    });\n  }\n  return res.status(404).json({\n    success: false,\n    message: `Parcel of id ${req.params.parcelId} does not exist`,\n  });\n});\n\n// Cancel a parcel delivery order\nrouter.put('/:parcelId/cancel', (req, res) => {\n  const parcel = Parcels.find(item => item.parcelId === Number.parseInt(req.params.parcelId, 5));\n  console.log(parcel);\n  let index = Parcels.indexOf(parcel);\n  if (index >= 0 && index < Parcels.length) {\n    Parcels[index].status = 'canceled';\n    if (Parcels[index].status === 'pending') {\n      return res.status(200).send({\n        success: true,\n        message: 'Parcel is successfully canceled',\n        parcel: index,\n      });\n    }\n    return res.status(405).send({\n      success: false,\n      message: 'Not allowed to cancel a parcel with status of delivered or transit',\n    });\n  }\n  return res.status(404).send({\n    success: false,\n    message: 'Parcel not found',\n  });\n});\n\nexport default router;\n"]}