'use strict';var cov_vcspnr813=function(){var path="/home/emmanuel/Projects/SelfProject/sendit/src/routes/parcels.js",hash="3a0da75971ba9568234c16b2835dc7d0f19274cf",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/home/emmanuel/Projects/SelfProject/sendit/src/routes/parcels.js",statementMap:{"0":{start:{line:3,column:0},end:{line:5,column:3}},"1":{start:{line:7,column:15},end:{line:7,column:33}},"2":{start:{line:9,column:16},end:{line:9,column:48}},"3":{start:{line:11,column:15},end:{line:11,column:41}},"4":{start:{line:13,column:16},end:{line:13,column:48}},"5":{start:{line:15,column:13},end:{line:15,column:37}},"6":{start:{line:17,column:14},end:{line:17,column:44}},"7":{start:{line:19,column:12},end:{line:19,column:27}},"8":{start:{line:21,column:13},end:{line:21,column:42}},"9":{start:{line:23,column:39},end:{line:23,column:93}},"10":{start:{line:25,column:35},end:{line:25,column:193}},"11":{start:{line:25,column:61},end:{line:25,column:145}},"12":{start:{line:25,column:126},end:{line:25,column:143}},"13":{start:{line:25,column:146},end:{line:25,column:158}},"14":{start:{line:25,column:168},end:{line:25,column:191}},"15":{start:{line:27,column:13},end:{line:27,column:39}},"16":{start:{line:30,column:0},end:{line:70,column:3}},"17":{start:{line:32,column:20},end:{line:32,column:22}},"18":{start:{line:33,column:21},end:{line:33,column:23}},"19":{start:{line:35,column:14},end:{line:35,column:20}},"20":{start:{line:37,column:13},end:{line:39,column:7}},"21":{start:{line:38,column:4},end:{line:38,column:47}},"22":{start:{line:41,column:23},end:{line:43,column:3}},"23":{start:{line:42,column:4},end:{line:42,column:83}},"24":{start:{line:44,column:2},end:{line:64,column:3}},"25":{start:{line:47,column:4},end:{line:47,column:109}},"26":{start:{line:48,column:14},end:{line:48,column:33}},"27":{start:{line:49,column:21},end:{line:49,column:48}},"28":{start:{line:50,column:4},end:{line:50,column:30}},"29":{start:{line:51,column:4},end:{line:51,column:34}},"30":{start:{line:54,column:4},end:{line:54,column:39}},"31":{start:{line:56,column:4},end:{line:56,column:35}},"32":{start:{line:57,column:4},end:{line:63,column:7}},"33":{start:{line:66,column:2},end:{line:69,column:5}},"34":{start:{line:73,column:0},end:{line:80,column:3}},"35":{start:{line:74,column:25},end:{line:74,column:73}},"36":{start:{line:75,column:2},end:{line:79,column:5}},"37":{start:{line:83,column:0},end:{line:99,column:3}},"38":{start:{line:84,column:23},end:{line:86,column:4}},"39":{start:{line:85,column:4},end:{line:85,column:66}},"40":{start:{line:88,column:2},end:{line:94,column:3}},"41":{start:{line:89,column:4},end:{line:93,column:7}},"42":{start:{line:95,column:2},end:{line:98,column:5}},"43":{start:{line:102,column:0},end:{line:125,column:3}},"44":{start:{line:103,column:15},end:{line:105,column:4}},"45":{start:{line:104,column:4},end:{line:104,column:49}},"46":{start:{line:106,column:14},end:{line:106,column:47}},"47":{start:{line:107,column:2},end:{line:107,column:21}},"48":{start:{line:108,column:2},end:{line:120,column:3}},"49":{start:{line:110,column:4},end:{line:115,column:5}},"50":{start:{line:111,column:6},end:{line:114,column:9}},"51":{start:{line:116,column:4},end:{line:119,column:7}},"52":{start:{line:121,column:2},end:{line:124,column:5}},"53":{start:{line:127,column:0},end:{line:127,column:25}}},fnMap:{"0":{name:"_interopRequireDefault",decl:{start:{line:23,column:9},end:{line:23,column:31}},loc:{start:{line:23,column:37},end:{line:23,column:95}},line:23},"1":{name:"_toConsumableArray",decl:{start:{line:25,column:9},end:{line:25,column:27}},loc:{start:{line:25,column:33},end:{line:25,column:195}},line:25},"2":{name:"(anonymous_2)",decl:{start:{line:30,column:17},end:{line:30,column:18}},loc:{start:{line:30,column:37},end:{line:70,column:1}},line:30},"3":{name:"(anonymous_3)",decl:{start:{line:37,column:36},end:{line:37,column:37}},loc:{start:{line:37,column:56},end:{line:39,column:3}},line:37},"4":{name:"calculatePrice",decl:{start:{line:41,column:32},end:{line:41,column:46}},loc:{start:{line:41,column:66},end:{line:43,column:3}},line:41},"5":{name:"(anonymous_5)",decl:{start:{line:73,column:16},end:{line:73,column:17}},loc:{start:{line:73,column:36},end:{line:80,column:1}},line:73},"6":{name:"(anonymous_6)",decl:{start:{line:83,column:25},end:{line:83,column:26}},loc:{start:{line:83,column:45},end:{line:99,column:1}},line:83},"7":{name:"(anonymous_7)",decl:{start:{line:84,column:48},end:{line:84,column:49}},loc:{start:{line:84,column:66},end:{line:86,column:3}},line:84},"8":{name:"(anonymous_8)",decl:{start:{line:102,column:32},end:{line:102,column:33}},loc:{start:{line:102,column:52},end:{line:125,column:1}},line:102},"9":{name:"(anonymous_9)",decl:{start:{line:103,column:38},end:{line:103,column:39}},loc:{start:{line:103,column:54},end:{line:105,column:3}},line:103}},branchMap:{"0":{loc:{start:{line:23,column:46},end:{line:23,column:92}},type:"cond-expr",locations:[{start:{line:23,column:70},end:{line:23,column:73}},{start:{line:23,column:76},end:{line:23,column:92}}],line:23},"1":{loc:{start:{line:23,column:46},end:{line:23,column:67}},type:"binary-expr",locations:[{start:{line:23,column:46},end:{line:23,column:49}},{start:{line:23,column:53},end:{line:23,column:67}}],line:23},"2":{loc:{start:{line:25,column:35},end:{line:25,column:193}},type:"if",locations:[{start:{line:25,column:35},end:{line:25,column:193}},{start:{line:25,column:35},end:{line:25,column:193}}],line:25},"3":{loc:{start:{line:44,column:2},end:{line:64,column:3}},type:"if",locations:[{start:{line:44,column:2},end:{line:64,column:3}},{start:{line:44,column:2},end:{line:64,column:3}}],line:44},"4":{loc:{start:{line:47,column:12},end:{line:47,column:108}},type:"cond-expr",locations:[{start:{line:47,column:50},end:{line:47,column:77}},{start:{line:47,column:80},end:{line:47,column:108}}],line:47},"5":{loc:{start:{line:88,column:2},end:{line:94,column:3}},type:"if",locations:[{start:{line:88,column:2},end:{line:94,column:3}},{start:{line:88,column:2},end:{line:94,column:3}}],line:88},"6":{loc:{start:{line:108,column:2},end:{line:120,column:3}},type:"if",locations:[{start:{line:108,column:2},end:{line:120,column:3}},{start:{line:108,column:2},end:{line:120,column:3}}],line:108},"7":{loc:{start:{line:110,column:4},end:{line:115,column:5}},type:"if",locations:[{start:{line:110,column:4},end:{line:115,column:5}},{start:{line:110,column:4},end:{line:115,column:5}}],line:110}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();cov_vcspnr813.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});var _express=(cov_vcspnr813.s[1]++,require('express'));var _express2=(cov_vcspnr813.s[2]++,_interopRequireDefault(_express));var _parcels=(cov_vcspnr813.s[3]++,require('../data/parcels'));var _parcels2=(cov_vcspnr813.s[4]++,_interopRequireDefault(_parcels));var _users=(cov_vcspnr813.s[5]++,require('../data/users'));var _users2=(cov_vcspnr813.s[6]++,_interopRequireDefault(_users));var _uuid=(cov_vcspnr813.s[7]++,require('uuid'));var _uuid2=(cov_vcspnr813.s[8]++,_interopRequireDefault(_uuid));function _interopRequireDefault(obj){cov_vcspnr813.f[0]++;cov_vcspnr813.s[9]++;return(cov_vcspnr813.b[1][0]++,obj)&&(cov_vcspnr813.b[1][1]++,obj.__esModule)?(cov_vcspnr813.b[0][0]++,obj):(cov_vcspnr813.b[0][1]++,{default:obj});}function _toConsumableArray(arr){cov_vcspnr813.f[1]++;cov_vcspnr813.s[10]++;if(Array.isArray(arr)){cov_vcspnr813.b[2][0]++;cov_vcspnr813.s[11]++;for(var i=0,arr2=Array(arr.length);i<arr.length;i++){cov_vcspnr813.s[12]++;arr2[i]=arr[i];}cov_vcspnr813.s[13]++;return arr2;}else{cov_vcspnr813.b[2][1]++;cov_vcspnr813.s[14]++;return Array.from(arr);}}var router=(cov_vcspnr813.s[15]++,_express2.default.Router());// Create parcel
cov_vcspnr813.s[16]++;router.post('/',function(req,res){cov_vcspnr813.f[2]++;// const { userId } = req.body;
var priceNormal=(cov_vcspnr813.s[17]++,20);// Price in $
var priceExpress=(cov_vcspnr813.s[18]++,70);// Parcel price in $
var price=(cov_vcspnr813.s[19]++,void 0);var user=(cov_vcspnr813.s[20]++,_users2.default.filter(function(customer){cov_vcspnr813.f[3]++;cov_vcspnr813.s[21]++;return customer.userId===req.body.userId;})[0]);cov_vcspnr813.s[22]++;var calculatePrice=function calculatePrice(pricePerOneWeight){cov_vcspnr813.f[4]++;cov_vcspnr813.s[23]++;return pricePerOneWeight*req.body.weight*req.body.height*req.body.length;};cov_vcspnr813.s[24]++;if(user){cov_vcspnr813.b[3][0]++;cov_vcspnr813.s[25]++;// Price per Service on Normal
// Price per Service on Express
price=req.body.From===req.body.services?(cov_vcspnr813.b[4][0]++,calculatePrice(priceNormal)):(cov_vcspnr813.b[4][1]++,calculatePrice(priceExpress));var pId=(cov_vcspnr813.s[26]++,_uuid2.default.v4());var parcelWith=(cov_vcspnr813.s[27]++,Object.assign({},req.body));cov_vcspnr813.s[28]++;parcelWith.parcelId=pId;cov_vcspnr813.s[29]++;parcelWith.status='pending';// Save parcel
cov_vcspnr813.s[30]++;_parcels2.default.push(parcelWith);cov_vcspnr813.s[31]++;console.log(_parcels2.default);cov_vcspnr813.s[32]++;return res.status(201).json({success:true,message:'Parcel created successfully',parcelId:pId,parcel:parcelWith,price:Number(price.toFixed(2))});}else{cov_vcspnr813.b[3][1]++;}cov_vcspnr813.s[33]++;return res.status(404).json({success:false,message:'User not Exist'});});// Get all parcels
cov_vcspnr813.s[34]++;router.get('/',function(req,res){cov_vcspnr813.f[5]++;var parcelDeliveries=(cov_vcspnr813.s[35]++,[].concat(_toConsumableArray(_parcels2.default)));cov_vcspnr813.s[36]++;res.status(200).json({success:true,message:'Parcels retrieved successfully',parcels:parcelDeliveries});});// Get a specific parcels
cov_vcspnr813.s[37]++;router.get('/:parcelId',function(req,res){cov_vcspnr813.f[6]++;var parcelDelivery=(cov_vcspnr813.s[38]++,_parcels2.default.filter(function(parcel){cov_vcspnr813.f[7]++;cov_vcspnr813.s[39]++;return parcel.parcel.parcelId===Number(req.params.parcelId);}));cov_vcspnr813.s[40]++;if(parcelDelivery.length>0){cov_vcspnr813.b[5][0]++;cov_vcspnr813.s[41]++;return res.status(200).json({success:true,message:'Parcel of id '+req.params.parcelId+' retrieved successfully',parcel:parcelDelivery[0]});}else{cov_vcspnr813.b[5][1]++;}cov_vcspnr813.s[42]++;return res.status(404).json({success:false,message:'Parcel of id '+req.params.parcelId+' does not exist'});});// Cancel a parcel delivery order
cov_vcspnr813.s[43]++;router.put('/:parcelId/cancel',function(req,res){cov_vcspnr813.f[8]++;var parcel=(cov_vcspnr813.s[44]++,_parcels2.default.find(function(item){cov_vcspnr813.f[9]++;cov_vcspnr813.s[45]++;return item.parcelId===req.params.parcelId;}));var index=(cov_vcspnr813.s[46]++,_parcels2.default.indexOf(parcel));cov_vcspnr813.s[47]++;console.log(index);cov_vcspnr813.s[48]++;if(index>=0){cov_vcspnr813.b[6][0]++;cov_vcspnr813.s[49]++;// Parcels[index].status = 'canceled';
if(_parcels2.default[index].status==='pending'){cov_vcspnr813.b[7][0]++;cov_vcspnr813.s[50]++;return res.status(200).send({success:true,message:'Parcel is successfully canceled'});}else{cov_vcspnr813.b[7][1]++;}cov_vcspnr813.s[51]++;return res.status(405).send({success:false,message:'Not allowed to cancel a parcel with status of delivered or transit'});}else{cov_vcspnr813.b[6][1]++;}cov_vcspnr813.s[52]++;return res.status(404).send({success:false,message:'Parcel not found'});});cov_vcspnr813.s[53]++;exports.default=router;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBhcmNlbHMuanMiXSwibmFtZXMiOlsicm91dGVyIiwiZXhwcmVzcyIsIlJvdXRlciIsInBvc3QiLCJyZXEiLCJyZXMiLCJwcmljZU5vcm1hbCIsInByaWNlRXhwcmVzcyIsInByaWNlIiwidXNlciIsIlVzZXIiLCJmaWx0ZXIiLCJjdXN0b21lciIsInVzZXJJZCIsImJvZHkiLCJjYWxjdWxhdGVQcmljZSIsInByaWNlUGVyT25lV2VpZ2h0Iiwid2VpZ2h0IiwiaGVpZ2h0IiwibGVuZ3RoIiwiRnJvbSIsInNlcnZpY2VzIiwicElkIiwidXVpZCIsInY0IiwicGFyY2VsV2l0aCIsInBhcmNlbElkIiwic3RhdHVzIiwiUGFyY2VscyIsInB1c2giLCJjb25zb2xlIiwibG9nIiwianNvbiIsInN1Y2Nlc3MiLCJtZXNzYWdlIiwicGFyY2VsIiwiTnVtYmVyIiwidG9GaXhlZCIsImdldCIsInBhcmNlbERlbGl2ZXJpZXMiLCJwYXJjZWxzIiwicGFyY2VsRGVsaXZlcnkiLCJwYXJhbXMiLCJwdXQiLCJmaW5kIiwiaXRlbSIsImluZGV4IiwiaW5kZXhPZiIsInNlbmQiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7Ozs7OztBQUVBLElBQU1BLFNBQVNDLGtCQUFRQyxNQUFSLEVBQWY7O0FBRUE7QUFDQUYsT0FBT0csSUFBUCxDQUFZLEdBQVosRUFBaUIsVUFBQ0MsR0FBRCxFQUFNQyxHQUFOLEVBQWM7QUFDN0I7QUFDQSxNQUFNQyxjQUFjLEVBQXBCLENBRjZCLENBRUw7QUFDeEIsTUFBTUMsZUFBZSxFQUFyQjtBQUNBO0FBQ0EsTUFBSUMsY0FBSjs7QUFFQSxNQUFNQyxPQUFPQyxnQkFBS0MsTUFBTCxDQUFZO0FBQUEsV0FBWUMsU0FBU0MsTUFBVCxLQUFvQlQsSUFBSVUsSUFBSixDQUFTRCxNQUF6QztBQUFBLEdBQVosRUFBNkQsQ0FBN0QsQ0FBYjs7QUFFQSxNQUFNRSxpQkFBaUIsU0FBakJBLGNBQWlCO0FBQUEsV0FD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LEVBQWdCO0FBQ2Q7QUFDQSxRQUFJbEIsa0JBQVFrQixLQUFSLEVBQWVuQixNQUFmLEtBQTBCLFNBQTlCLEVBQXlDO0FBQ3ZDLGFBQU90QixJQUFJc0IsTUFBSixDQUFXLEdBQVgsRUFBZ0JxQixJQUFoQixDQUFxQjtBQUMxQmYsaUJBQVMsSUFEaUI7QUFFMUJDLGlCQUFTO0FBRmlCLE9BQXJCLENBQVA7QUFJRDtBQUNELFdBQU83QixJQUFJc0IsTUFBSixDQUFXLEdBQVgsRUFBZ0JxQixJQUFoQixDQUFxQjtBQUMxQmYsZUFBUyxLQURpQjtBQUUxQkMsZUFBUztBQUZpQixLQUFyQixDQUFQO0FBSUQ7QUFDRCxTQUFPN0IsSUFBSXNCLE1BQUosQ0FBVyxHQUFYLEVBQWdCcUIsSUFBaEIsQ0FBcUI7QUFDMUJmLGFBQVMsS0FEaUI7QUFFMUJDLGFBQVM7QUFGaUIsR0FBckIsQ0FBUDtBQUlELENBckJEOztrQkF1QmVsQyxNIiwiZmlsZSI6InBhcmNlbHMuanMiLCJzb3VyY2VSb290IjoiL2hvbWUvZW1tYW51ZWwvUHJvamVjdHMvU2VsZlByb2plY3Qvc2VuZGl0L3NyYy9yb3V0ZXMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZXhwcmVzcyBmcm9tICdleHByZXNzJztcbmltcG9ydCBQYXJjZWxzIGZyb20gJy4uL2RhdGEvcGFyY2Vscyc7XG5pbXBvcnQgVXNlciBmcm9tICcuLi9kYXRhL3VzZXJzJztcbmltcG9ydCB1dWlkIGZyb20gJ3V1aWQnO1xuXG5jb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xuXG4vLyBDcmVhdGUgcGFyY2VsXG5yb3V0ZXIucG9zdCgnLycsIChyZXEsIHJlcykgPT4ge1xuICAvLyBjb25zdCB7IHVzZXJJZCB9ID0gcmVxLmJvZHk7XG4gIGNvbnN0IHByaWNlTm9ybWFsID0gMjA7IC8vIFByaWNlIGluICRcbiAgY29uc3QgcHJpY2VFeHByZXNzID0gNzA7XG4gIC8vIFBhcmNlbCBwcmljZSBpbiAkXG4gIGxldCBwcmljZTtcblxuICBjb25zdCB1c2VyID0gVXNlci5maWx0ZXIoY3VzdG9tZXIgPT4gY3VzdG9tZXIudXNlcklkID09PSByZXEuYm9keS51c2VySWQpWzBdO1xuXG4gIGNvbnN0IGNhbGN1bGF0ZVByaWNlID0gcHJpY2VQZXJPbmVXZWlnaHQgPT4gKFxuICAgIChwcmljZVBlck9uZVdlaWdodCAqIHJlcS5ib2R5LndlaWdodCAqIHJlcS5ib2R5LmhlaWdodCAqIHJlcS5ib2R5Lmxlbmd0aClcbiAgKTtcbiAgaWYgKHVzZXIpIHtcbiAgICAvLyBQcmljZSBwZXIgU2VydmljZSBvbiBOb3JtYWxcbiAgICAvLyBQcmljZSBwZXIgU2VydmljZSBvbiBFeHByZXNzXG4gICAgcHJpY2UgPSByZXEuYm9keS5Gcm9tID09PSByZXEuYm9keS5zZXJ2aWNlc1xuICAgICAgPyBjYWxjdWxhdGVQcmljZShwcmljZU5vcm1hbClcbiAgICAgIDogY2FsY3VsYXRlUHJpY2UocHJpY2VFeHByZXNzKTtcbiAgICBjb25zdCBwSWQgPSB1dWlkLnY0KCk7XG4gICAgY29uc3QgcGFyY2VsV2l0aCA9IHsgLi4ucmVxLmJvZHkgfTtcbiAgICBwYXJjZWxXaXRoLnBhcmNlbElkID0gcElkO1xuICAgIHBhcmNlbFdpdGguc3RhdHVzID0gJ3BlbmRpbmcnO1xuXG4gICAgLy8gU2F2ZSBwYXJjZWxcbiAgICBQYXJjZWxzLnB1c2gocGFyY2VsV2l0aCk7XG5cbiAgICBjb25zb2xlLmxvZyhQYXJjZWxzKTtcbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDEpLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG1lc3NhZ2U6ICdQYXJjZWwgY3JlYXRlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgcGFyY2VsSWQ6IHBJZCxcbiAgICAgIHBhcmNlbDogcGFyY2VsV2l0aCxcbiAgICAgIHByaWNlOiBOdW1iZXIocHJpY2UudG9GaXhlZCgyKSksXG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oe1xuICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgIG1lc3NhZ2U6ICdVc2VyIG5vdCBFeGlzdCcsXG4gIH0pO1xufSk7XG5cbi8vIEdldCBhbGwgcGFyY2Vsc1xucm91dGVyLmdldCgnLycsIChyZXEsIHJlcykgPT4ge1xuICBjb25zdCBwYXJjZWxEZWxpdmVyaWVzID0gWy4uLlBhcmNlbHNdO1xuICByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gICAgc3VjY2VzczogdHJ1ZSxcbiAgICBtZXNzYWdlOiAnUGFyY2VscyByZXRyaWV2ZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgICBwYXJjZWxzOiBwYXJjZWxEZWxpdmVyaWVzLFxuICB9KTtcbn0pO1xuXG4vLyBHZXQgYSBzcGVjaWZpYyBwYXJjZWxzXG5yb3V0ZXIuZ2V0KCcvOnBhcmNlbElkJywgKHJlcSwgcmVzKSA9PiB7XG4gIGNvbnN0IHBhcmNlbERlbGl2ZXJ5ID0gUGFyY2Vscy5maWx0ZXIoXG4gICAgcGFyY2VsID0+IHBhcmNlbC5wYXJjZWwucGFyY2VsSWQgPT09IE51bWJlcihyZXEucGFyYW1zLnBhcmNlbElkKSxcbiAgKTtcblxuICBpZiAocGFyY2VsRGVsaXZlcnkubGVuZ3RoID4gMCkge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgbWVzc2FnZTogYFBhcmNlbCBvZiBpZCAke3JlcS5wYXJhbXMucGFyY2VsSWR9IHJldHJpZXZlZCBzdWNjZXNzZnVsbHlgLFxuICAgICAgcGFyY2VsOiBwYXJjZWxEZWxpdmVyeVswXSxcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oe1xuICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgIG1lc3NhZ2U6IGBQYXJjZWwgb2YgaWQgJHtyZXEucGFyYW1zLnBhcmNlbElkfSBkb2VzIG5vdCBleGlzdGAsXG4gIH0pO1xufSk7XG5cbi8vIENhbmNlbCBhIHBhcmNlbCBkZWxpdmVyeSBvcmRlclxucm91dGVyLnB1dCgnLzpwYXJjZWxJZC9jYW5jZWwnLCAocmVxLCByZXMpID0+IHtcbiAgY29uc3QgcGFyY2VsID0gUGFyY2Vscy5maW5kKGl0ZW0gPT4gaXRlbS5wYXJjZWxJZCA9PT0gcmVxLnBhcmFtcy5wYXJjZWxJZCk7XG4gIGNvbnN0IGluZGV4ID0gUGFyY2Vscy5pbmRleE9mKHBhcmNlbCk7IFxuICBjb25zb2xlLmxvZyhpbmRleCk7XG4gIGlmIChpbmRleCA+PSAwKSB7XG4gICAgLy8gUGFyY2Vsc1tpbmRleF0uc3RhdHVzID0gJ2NhbmNlbGVkJztcbiAgICBpZiAoUGFyY2Vsc1tpbmRleF0uc3RhdHVzID09PSAncGVuZGluZycpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuc2VuZCh7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIG1lc3NhZ2U6ICdQYXJjZWwgaXMgc3VjY2Vzc2Z1bGx5IGNhbmNlbGVkJyxcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLnNlbmQoe1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBtZXNzYWdlOiAnTm90IGFsbG93ZWQgdG8gY2FuY2VsIGEgcGFyY2VsIHdpdGggc3RhdHVzIG9mIGRlbGl2ZXJlZCBvciB0cmFuc2l0JyxcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLnNlbmQoe1xuICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgIG1lc3NhZ2U6ICdQYXJjZWwgbm90IGZvdW5kJyxcbiAgfSk7XG59KTtcblxuZXhwb3J0IGRlZmF1bHQgcm91dGVyO1xuIl19