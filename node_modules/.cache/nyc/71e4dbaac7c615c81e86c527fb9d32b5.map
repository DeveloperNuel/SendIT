{"version":3,"sources":["parcels.js"],"names":["router","express","Router","post","req","res","priceNormal","priceExpress","price","user","User","filter","customer","userId","body","calculatePrice","pricePerOneWeight","weight","height","length","From","services","pId","uuid","v4","parcelWith","parcelId","status","Parcels","push","console","log","json","success","message","parcel","Number","toFixed","get","parcelDeliveries","parcels","params","parcelDelivery","put","find","item","index","indexOf","send"],"mappings":"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","file":"parcels.js","sourceRoot":"/home/emmanuel/Projects/SelfProject/sendit/src/routes","sourcesContent":["import express from 'express';\nimport Parcels from '../data/parcels';\nimport User from '../data/users';\nimport uuid from 'uuid';\n\nconst router = express.Router();\n\n// Create parcel\nrouter.post('/', (req, res) => {\n  // const { userId } = req.body;\n  const priceNormal = 20; // Price in $\n  const priceExpress = 70;\n  // Parcel price in $\n  let price;\n\n  const user = User.filter(customer => customer.userId === req.body.userId)[0];\n\n  const calculatePrice = pricePerOneWeight => (\n    (pricePerOneWeight * req.body.weight * req.body.height * req.body.length)\n  );\n  if (user) {\n    // Price per Service on Normal\n    // Price per Service on Express\n    price = req.body.From === req.body.services\n      ? calculatePrice(priceNormal)\n      : calculatePrice(priceExpress);\n    const pId = uuid.v4();\n    const parcelWith = { ...req.body };\n    parcelWith.parcelId = pId;\n    parcelWith.status = 'pending';\n\n    // Save parcel\n    Parcels.push(parcelWith);\n\n    console.log(Parcels);\n    return res.status(201).json({\n      success: true,\n      message: 'Parcel created successfully',\n      parcelId: pId,\n      parcel: parcelWith,\n      price: Number(price.toFixed(2)),\n    });\n  }\n\n  return res.status(404).json({\n    success: false,\n    message: 'User not Exist',\n  });\n});\n\n// Get all parcels\nrouter.get('/', (req, res) => {\n  const parcelDeliveries = [...Parcels];\n  res.status(200).json({\n    success: true,\n    message: 'Parcels retrieved successfully',\n    parcels: parcelDeliveries,\n  });\n});\n\n// Get a specific parcels\nrouter.get('/:parcelId', (req, res) => {\n  console.log(req.params.parcelId);\n  const parcelDelivery = Parcels.filter(\n    parcel => parcel.parcelId === req.params.parcelId,\n  );\n\n  if (parcelDelivery.length > 0) {\n    return res.status(200).json({\n      success: true,\n      message: `Parcel of id ${req.params.parcelId} retrieved successfully`,\n      parcel: parcelDelivery[0],\n    });\n  }\n  return res.status(404).json({\n    success: false,\n    message: `Parcel of id ${req.params.parcelId} does not exist`,\n  });\n});\n\n// Cancel a parcel delivery order\nrouter.put('/:parcelId/cancel', (req, res) => {\n  const parcel = Parcels.find(item => item.parcelId === req.params.parcelId);\n  const index = Parcels.indexOf(parcel); \n  console.log(index);\n  if (index >= 0) {\n    // Parcels[index].status = 'canceled';\n    if (Parcels[index].status === 'pending') {\n      return res.status(200).send({\n        success: true,\n        message: 'Parcel is successfully canceled',\n      });\n    }\n    return res.status(405).send({\n      success: false,\n      message: 'Not allowed to cancel a parcel with status of delivered or transit',\n    });\n  }\n  return res.status(404).send({\n    success: false,\n    message: 'Parcel not found',\n  });\n});\n\nexport default router;\n"]}