'use strict';var cov_vcspnr813=function(){var path="/home/emmanuel/Projects/SelfProject/sendit/src/routes/parcels.js",hash="fd773238b6657e08415cfdf225009fe9d36da849",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/home/emmanuel/Projects/SelfProject/sendit/src/routes/parcels.js",statementMap:{"0":{start:{line:3,column:0},end:{line:5,column:3}},"1":{start:{line:7,column:15},end:{line:7,column:33}},"2":{start:{line:9,column:16},end:{line:9,column:48}},"3":{start:{line:11,column:15},end:{line:11,column:41}},"4":{start:{line:13,column:16},end:{line:13,column:48}},"5":{start:{line:15,column:13},end:{line:15,column:37}},"6":{start:{line:17,column:14},end:{line:17,column:44}},"7":{start:{line:19,column:39},end:{line:19,column:93}},"8":{start:{line:21,column:13},end:{line:21,column:39}},"9":{start:{line:24,column:0},end:{line:68,column:3}},"10":{start:{line:25,column:2},end:{line:25,column:24}},"11":{start:{line:26,column:18},end:{line:26,column:26}},"12":{start:{line:27,column:15},end:{line:27,column:31}},"13":{start:{line:28,column:15},end:{line:28,column:31}},"14":{start:{line:30,column:20},end:{line:30,column:22}},"15":{start:{line:31,column:21},end:{line:31,column:23}},"16":{start:{line:33,column:14},end:{line:33,column:20}},"17":{start:{line:35,column:13},end:{line:37,column:7}},"18":{start:{line:36,column:4},end:{line:36,column:38}},"19":{start:{line:39,column:23},end:{line:41,column:3}},"20":{start:{line:40,column:4},end:{line:40,column:77}},"21":{start:{line:42,column:2},end:{line:62,column:3}},"22":{start:{line:45,column:4},end:{line:45,column:104}},"23":{start:{line:47,column:14},end:{line:47,column:42}},"24":{start:{line:48,column:21},end:{line:48,column:27}},"25":{start:{line:49,column:4},end:{line:49,column:30}},"26":{start:{line:50,column:4},end:{line:50,column:34}},"27":{start:{line:53,column:4},end:{line:53,column:81}},"28":{start:{line:55,column:4},end:{line:55,column:35}},"29":{start:{line:56,column:4},end:{line:61,column:7}},"30":{start:{line:64,column:2},end:{line:67,column:5}},"31":{start:{line:71,column:0},end:{line:82,column:3}},"32":{start:{line:72,column:25},end:{line:72,column:27}},"33":{start:{line:73,column:2},end:{line:73,column:33}},"34":{start:{line:74,column:2},end:{line:76,column:5}},"35":{start:{line:75,column:4},end:{line:75,column:48}},"36":{start:{line:77,column:2},end:{line:81,column:5}},"37":{start:{line:85,column:0},end:{line:101,column:3}},"38":{start:{line:86,column:23},end:{line:88,column:4}},"39":{start:{line:87,column:4},end:{line:87,column:66}},"40":{start:{line:90,column:2},end:{line:96,column:3}},"41":{start:{line:91,column:4},end:{line:95,column:7}},"42":{start:{line:97,column:2},end:{line:100,column:5}},"43":{start:{line:104,column:0},end:{line:141,column:3}},"44":{start:{line:105,column:23},end:{line:105,column:25}},"45":{start:{line:106,column:14},end:{line:106,column:20}},"46":{start:{line:107,column:2},end:{line:107,column:52}},"47":{start:{line:108,column:2},end:{line:114,column:3}},"48":{start:{line:109,column:4},end:{line:113,column:5}},"49":{start:{line:110,column:6},end:{line:110,column:51}},"50":{start:{line:111,column:6},end:{line:111,column:16}},"51":{start:{line:112,column:6},end:{line:112,column:12}},"52":{start:{line:116,column:2},end:{line:136,column:3}},"53":{start:{line:117,column:4},end:{line:131,column:5}},"54":{start:{line:118,column:6},end:{line:118,column:41}},"55":{start:{line:119,column:6},end:{line:126,column:7}},"56":{start:{line:120,column:8},end:{line:120,column:60}},"57":{start:{line:121,column:8},end:{line:125,column:11}},"58":{start:{line:127,column:6},end:{line:130,column:9}},"59":{start:{line:132,column:4},end:{line:135,column:7}},"60":{start:{line:137,column:2},end:{line:140,column:5}},"61":{start:{line:143,column:0},end:{line:143,column:25}}},fnMap:{"0":{name:"_interopRequireDefault",decl:{start:{line:19,column:9},end:{line:19,column:31}},loc:{start:{line:19,column:37},end:{line:19,column:95}},line:19},"1":{name:"(anonymous_1)",decl:{start:{line:24,column:17},end:{line:24,column:18}},loc:{start:{line:24,column:37},end:{line:68,column:1}},line:24},"2":{name:"(anonymous_2)",decl:{start:{line:35,column:36},end:{line:35,column:37}},loc:{start:{line:35,column:56},end:{line:37,column:3}},line:35},"3":{name:"calculatePrice",decl:{start:{line:39,column:32},end:{line:39,column:46}},loc:{start:{line:39,column:66},end:{line:41,column:3}},line:39},"4":{name:"(anonymous_4)",decl:{start:{line:71,column:16},end:{line:71,column:17}},loc:{start:{line:71,column:36},end:{line:82,column:1}},line:71},"5":{name:"(anonymous_5)",decl:{start:{line:74,column:24},end:{line:74,column:25}},loc:{start:{line:74,column:42},end:{line:76,column:3}},line:74},"6":{name:"(anonymous_6)",decl:{start:{line:85,column:25},end:{line:85,column:26}},loc:{start:{line:85,column:45},end:{line:101,column:1}},line:85},"7":{name:"(anonymous_7)",decl:{start:{line:86,column:48},end:{line:86,column:49}},loc:{start:{line:86,column:66},end:{line:88,column:3}},line:86},"8":{name:"(anonymous_8)",decl:{start:{line:104,column:32},end:{line:104,column:33}},loc:{start:{line:104,column:52},end:{line:141,column:1}},line:104}},branchMap:{"0":{loc:{start:{line:19,column:46},end:{line:19,column:92}},type:"cond-expr",locations:[{start:{line:19,column:70},end:{line:19,column:73}},{start:{line:19,column:76},end:{line:19,column:92}}],line:19},"1":{loc:{start:{line:19,column:46},end:{line:19,column:67}},type:"binary-expr",locations:[{start:{line:19,column:46},end:{line:19,column:49}},{start:{line:19,column:53},end:{line:19,column:67}}],line:19},"2":{loc:{start:{line:42,column:2},end:{line:62,column:3}},type:"if",locations:[{start:{line:42,column:2},end:{line:62,column:3}},{start:{line:42,column:2},end:{line:62,column:3}}],line:42},"3":{loc:{start:{line:45,column:12},end:{line:45,column:103}},type:"cond-expr",locations:[{start:{line:45,column:45},end:{line:45,column:72}},{start:{line:45,column:75},end:{line:45,column:103}}],line:45},"4":{loc:{start:{line:90,column:2},end:{line:96,column:3}},type:"if",locations:[{start:{line:90,column:2},end:{line:96,column:3}},{start:{line:90,column:2},end:{line:96,column:3}}],line:90},"5":{loc:{start:{line:109,column:4},end:{line:113,column:5}},type:"if",locations:[{start:{line:109,column:4},end:{line:113,column:5}},{start:{line:109,column:4},end:{line:113,column:5}}],line:109},"6":{loc:{start:{line:116,column:2},end:{line:136,column:3}},type:"if",locations:[{start:{line:116,column:2},end:{line:136,column:3}},{start:{line:116,column:2},end:{line:136,column:3}}],line:116},"7":{loc:{start:{line:117,column:4},end:{line:131,column:5}},type:"if",locations:[{start:{line:117,column:4},end:{line:131,column:5}},{start:{line:117,column:4},end:{line:131,column:5}}],line:117},"8":{loc:{start:{line:117,column:8},end:{line:117,column:83}},type:"binary-expr",locations:[{start:{line:117,column:8},end:{line:117,column:43}},{start:{line:117,column:47},end:{line:117,column:83}}],line:117},"9":{loc:{start:{line:119,column:6},end:{line:126,column:7}},type:"if",locations:[{start:{line:119,column:6},end:{line:126,column:7}},{start:{line:119,column:6},end:{line:126,column:7}}],line:119}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();cov_vcspnr813.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});var _express=(cov_vcspnr813.s[1]++,require('express'));var _express2=(cov_vcspnr813.s[2]++,_interopRequireDefault(_express));var _parcels=(cov_vcspnr813.s[3]++,require('../data/parcels'));var _parcels2=(cov_vcspnr813.s[4]++,_interopRequireDefault(_parcels));var _users=(cov_vcspnr813.s[5]++,require('../data/users'));var _users2=(cov_vcspnr813.s[6]++,_interopRequireDefault(_users));function _interopRequireDefault(obj){cov_vcspnr813.f[0]++;cov_vcspnr813.s[7]++;return(cov_vcspnr813.b[1][0]++,obj)&&(cov_vcspnr813.b[1][1]++,obj.__esModule)?(cov_vcspnr813.b[0][0]++,obj):(cov_vcspnr813.b[0][1]++,{default:obj});}var router=(cov_vcspnr813.s[8]++,_express2.default.Router());// Create parcel
cov_vcspnr813.s[9]++;router.post('/',function(req,res){cov_vcspnr813.f[1]++;cov_vcspnr813.s[10]++;console.log(req.body);var _req$body=(cov_vcspnr813.s[11]++,req.body),userId=(cov_vcspnr813.s[12]++,_req$body.userId),parcel=(cov_vcspnr813.s[13]++,_req$body.parcel);var priceNormal=(cov_vcspnr813.s[14]++,20);// Price in $
var priceExpress=(cov_vcspnr813.s[15]++,70);// Parcel price in $
var price=(cov_vcspnr813.s[16]++,void 0);var user=(cov_vcspnr813.s[17]++,_users2.default.filter(function(customer){cov_vcspnr813.f[2]++;cov_vcspnr813.s[18]++;return customer.userId===userId;})[0]);cov_vcspnr813.s[19]++;var calculatePrice=function calculatePrice(pricePerOneWeight){cov_vcspnr813.f[3]++;cov_vcspnr813.s[20]++;return pricePerOneWeight*parcel.weight*parcel.height*parcel.length;};cov_vcspnr813.s[21]++;if(user){cov_vcspnr813.b[2][0]++;cov_vcspnr813.s[22]++;// Price per Service on Normal
// Price per Service on Express
price=parcel.From===parcel.Service?(cov_vcspnr813.b[3][0]++,calculatePrice(priceNormal)):(cov_vcspnr813.b[3][1]++,calculatePrice(priceExpress));// Parcel Id
var pId=(cov_vcspnr813.s[23]++,_parcels2.default.length+1);var parcelWith=(cov_vcspnr813.s[24]++,parcel);cov_vcspnr813.s[25]++;parcelWith.parcelId=pId;cov_vcspnr813.s[26]++;parcelWith.status='Pending';// Save parcel
cov_vcspnr813.s[27]++;_parcels2.default.push({userId:userId,price:price,parcel:parcelWith});cov_vcspnr813.s[28]++;console.log(_parcels2.default);cov_vcspnr813.s[29]++;return res.status(201).json({success:true,message:'Parcel created successfully',parcelId:pId,price:Number(price.toFixed(2))});}else{cov_vcspnr813.b[2][1]++;}cov_vcspnr813.s[30]++;return res.status(404).json({success:false,message:'User not Exist'});});// Get all parcels
cov_vcspnr813.s[31]++;router.get('/',function(req,res){cov_vcspnr813.f[4]++;var parcelDeliveries=(cov_vcspnr813.s[32]++,[]);cov_vcspnr813.s[33]++;console.log(_parcels2.default);cov_vcspnr813.s[34]++;_parcels2.default.map(function(parcel){cov_vcspnr813.f[5]++;cov_vcspnr813.s[35]++;return parcelDeliveries.push(parcel.parcel);});cov_vcspnr813.s[36]++;res.status(200).json({success:true,message:'Parcels retrieved successfully',parcels:parcelDeliveries});});// Get a specific parcels
cov_vcspnr813.s[37]++;router.get('/:parcelId',function(req,res){cov_vcspnr813.f[6]++;var parcelDelivery=(cov_vcspnr813.s[38]++,_parcels2.default.filter(function(parcel){cov_vcspnr813.f[7]++;cov_vcspnr813.s[39]++;return parcel.parcel.parcelId===Number(req.params.parcelId);}));cov_vcspnr813.s[40]++;if(parcelDelivery.length>0){cov_vcspnr813.b[4][0]++;cov_vcspnr813.s[41]++;return res.status(200).json({success:true,message:'Parcel of id '+req.params.parcelId+' retrieved successfully',parcel:parcelDelivery[0]});}else{cov_vcspnr813.b[4][1]++;}cov_vcspnr813.s[42]++;return res.status(404).json({success:false,message:'Parcel of id '+req.params.parcelId+' does not exist'});});// Cancel a parcel delivery order
cov_vcspnr813.s[43]++;router.put('/:parcelId/cancel',function(req,res){cov_vcspnr813.f[8]++;var parcelDelivery=(cov_vcspnr813.s[44]++,{});var index=(cov_vcspnr813.s[45]++,void 0);cov_vcspnr813.s[46]++;req.params.parcelId=Number(req.params.parcelId);cov_vcspnr813.s[47]++;for(var i=0;i<_parcels2.default.length;i+=1){cov_vcspnr813.s[48]++;if(_parcels2.default[i].parcel.parcelId===req.params.parcelId){cov_vcspnr813.b[5][0]++;cov_vcspnr813.s[49]++;parcelDelivery=_parcels2.default[i].parcel;cov_vcspnr813.s[50]++;index=i;cov_vcspnr813.s[51]++;break;}else{cov_vcspnr813.b[5][1]++;}}cov_vcspnr813.s[52]++;if(parcelDelivery){cov_vcspnr813.b[6][0]++;cov_vcspnr813.s[53]++;if((cov_vcspnr813.b[8][0]++,parcelDelivery.status==='pending')||(cov_vcspnr813.b[8][1]++,parcelDelivery.status==='canceled')){cov_vcspnr813.b[7][0]++;cov_vcspnr813.s[54]++;parcelDelivery.status='canceled';cov_vcspnr813.s[55]++;if(_parcels2.default[index].parcel.parcelId===parcelDelivery.parcelId){cov_vcspnr813.b[9][0]++;cov_vcspnr813.s[56]++;_parcels2.default[index].parcel.status='canceled';cov_vcspnr813.s[57]++;return res.status(200).send({success:true,message:'Parcel is successfully canceled',parcel:parcelDelivery});}else{cov_vcspnr813.b[9][1]++;}cov_vcspnr813.s[58]++;return res.status(405).send({success:false,message:'Data index changed. Try again!'});}else{cov_vcspnr813.b[7][1]++;}cov_vcspnr813.s[59]++;return res.status(405).send({success:false,message:'Not allowed to cancel a parcel with status of delivered or transit'});}else{cov_vcspnr813.b[6][1]++;}cov_vcspnr813.s[60]++;return res.status(404).send({success:false,message:'Parcel not found'});});cov_vcspnr813.s[61]++;exports.default=router;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBhcmNlbHMuanMiXSwibmFtZXMiOlsicm91dGVyIiwiZXhwcmVzcyIsIlJvdXRlciIsInBvc3QiLCJyZXEiLCJyZXMiLCJjb25zb2xlIiwibG9nIiwiYm9keSIsInVzZXJJZCIsInBhcmNlbCIsInByaWNlTm9ybWFsIiwicHJpY2VFeHByZXNzIiwicHJpY2UiLCJ1c2VyIiwiVXNlciIsImZpbHRlciIsImN1c3RvbWVyIiwiY2FsY3VsYXRlUHJpY2UiLCJwcmljZVBlck9uZVdlaWdodCIsIndlaWdodCIsImhlaWdodCIsImxlbmd0aCIsIkZyb20iLCJTZXJ2aWNlIiwicElkIiwiUGFyY2VscyIsInBhcmNlbFdpdGgiLCJwYXJjZWxJZCIsInN0YXR1cyIsInB1c2giLCJqc29uIiwic3VjY2VzcyIsIm1lc3NhZ2UiLCJOdW1iZXIiLCJ0b0ZpeGVkIiwiZ2V0IiwicGFyY2VsRGVsaXZlcmllcyIsIm1hcCIsInBhcmNlbHMiLCJwYXJjZWxEZWxpdmVyeSIsInBhcmFtcyIsInB1dCIsImluZGV4IiwiaSIsInNlbmQiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBOzs7O0FBQ0E7Ozs7QUFDQTs7Ozs7O0FBRUEsSUFBTUEsU0FBU0Msa0JBQVFDLE1BQVIsRUFBZjs7QUFFQTtBQUNBRixPQUFPRyxJQUFQLENBQVksR0FBWixFQUFpQixVQUFDQyxHQUFELEVBQU1DLEdBQU4sRUFBYztBQUM3QkMsVUFBUUMsR0FBUixDQUFZSCxJQUFJSSxJQUFoQjtBQUQ2QixrQkFFRkosSUFBSUksSUFGRjtBQUFBLE1BRXJCQyxNQUZxQixhQUVyQkEsTUFGcUI7QUFBQSxNQUViQyxNQUZhLGFBRWJBLE1BRmE7O0FBRzdCLE1BQU1DLGNBQWMsRUFBcEIsQ0FINkIsQ0FHTDtBQUN4QixNQUFNQyxlQUFlLEVBQXJCO0FBQ0E7QUFDQSxNQUFJQyxjQUFKOztBQUVBLE1BQU1DLE9BQU9DLGdCQUFLQyxNQUFMLENBQVk7QUFBQSxXQUFZQyxTQUFTUixNQUFULEtBQW9CQSxNQUFoQztBQUFBLEdB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SUFBSXdCLE1BQUosQ0FBVyxHQUFYLEVBQWdCZ0IsSUFBaEIsQ0FBcUI7QUFDMUJiLGFBQVMsS0FEaUI7QUFFMUJDLGFBQVM7QUFGaUIsR0FBckIsQ0FBUDtBQUlELENBeENEOztrQkEwQ2VqQyxNIiwiZmlsZSI6InBhcmNlbHMuanMiLCJzb3VyY2VSb290IjoiL2hvbWUvZW1tYW51ZWwvUHJvamVjdHMvU2VsZlByb2plY3Qvc2VuZGl0L3NyYy9yb3V0ZXMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZXhwcmVzcyBmcm9tICdleHByZXNzJztcbmltcG9ydCBQYXJjZWxzIGZyb20gJy4uL2RhdGEvcGFyY2Vscyc7XG5pbXBvcnQgVXNlciBmcm9tICcuLi9kYXRhL3VzZXJzJztcblxuY29uc3Qgcm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTtcblxuLy8gQ3JlYXRlIHBhcmNlbFxucm91dGVyLnBvc3QoJy8nLCAocmVxLCByZXMpID0+IHtcbiAgY29uc29sZS5sb2cocmVxLmJvZHkpO1xuICBjb25zdCB7IHVzZXJJZCwgcGFyY2VsIH0gPSByZXEuYm9keTtcbiAgY29uc3QgcHJpY2VOb3JtYWwgPSAyMDsgLy8gUHJpY2UgaW4gJFxuICBjb25zdCBwcmljZUV4cHJlc3MgPSA3MDtcbiAgLy8gUGFyY2VsIHByaWNlIGluICRcbiAgbGV0IHByaWNlO1xuXG4gIGNvbnN0IHVzZXIgPSBVc2VyLmZpbHRlcihjdXN0b21lciA9PiBjdXN0b21lci51c2VySWQgPT09IHVzZXJJZClbMF07XG5cbiAgY29uc3QgY2FsY3VsYXRlUHJpY2UgPSBwcmljZVBlck9uZVdlaWdodCA9PiAoXG4gICAgKHByaWNlUGVyT25lV2VpZ2h0ICogcGFyY2VsLndlaWdodCAqIHBhcmNlbC5oZWlnaHQgKiBwYXJjZWwubGVuZ3RoKVxuICApO1xuICBpZiAodXNlcikge1xuICAgIC8vIFByaWNlIHBlciBTZXJ2aWNlIG9uIE5vcm1hbFxuICAgIC8vIFByaWNlIHBlciBTZXJ2aWNlIG9uIEV4cHJlc3NcbiAgICBwcmljZSA9IHBhcmNlbC5Gcm9tID09PSBwYXJjZWwuU2VydmljZVxuICAgICAgPyBjYWxjdWxhdGVQcmljZShwcmljZU5vcm1hbClcbiAgICAgIDogY2FsY3VsYXRlUHJpY2UocHJpY2VFeHByZXNzKTtcbiAgICAvLyBQYXJjZWwgSWRcbiAgICBjb25zdCBwSWQgPSBQYXJjZWxzLmxlbmd0aCArIDE7XG4gICAgY29uc3QgcGFyY2VsV2l0aCA9IHBhcmNlbDtcbiAgICBwYXJjZWxXaXRoLnBhcmNlbElkID0gcElkO1xuICAgIHBhcmNlbFdpdGguc3RhdHVzID0gJ1BlbmRpbmcnO1xuXG4gICAgLy8gU2F2ZSBwYXJjZWxcbiAgICBQYXJjZWxzLnB1c2goeyB1c2VySWQsIHByaWNlLCBwYXJjZWw6IHBhcmNlbFdpdGggfSk7XG5cbiAgICBjb25zb2xlLmxvZyhQYXJjZWxzKTtcbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDEpLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG1lc3NhZ2U6ICdQYXJjZWwgY3JlYXRlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgcGFyY2VsSWQ6IHBJZCxcbiAgICAgIHByaWNlOiBOdW1iZXIocHJpY2UudG9GaXhlZCgyKSksXG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oe1xuICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgIG1lc3NhZ2U6ICdVc2VyIG5vdCBFeGlzdCcsXG4gIH0pO1xufSk7XG5cbi8vIEdldCBhbGwgcGFyY2Vsc1xucm91dGVyLmdldCgnLycsIChyZXEsIHJlcykgPT4ge1xuICBjb25zdCBwYXJjZWxEZWxpdmVyaWVzID0gW107XG4gIGNvbnNvbGUubG9nKFBhcmNlbHMpO1xuICBQYXJjZWxzLm1hcChwYXJjZWwgPT4gcGFyY2VsRGVsaXZlcmllcy5wdXNoKHBhcmNlbC5wYXJjZWwpKTtcbiAgcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgbWVzc2FnZTogJ1BhcmNlbHMgcmV0cmlldmVkIHN1Y2Nlc3NmdWxseScsXG4gICAgcGFyY2VsczogcGFyY2VsRGVsaXZlcmllcyxcbiAgfSk7XG59KTtcblxuLy8gR2V0IGEgc3BlY2lmaWMgcGFyY2Vsc1xucm91dGVyLmdldCgnLzpwYXJjZWxJZCcsIChyZXEsIHJlcykgPT4ge1xuICBjb25zdCBwYXJjZWxEZWxpdmVyeSA9IFBhcmNlbHMuZmlsdGVyKFxuICAgIHBhcmNlbCA9PiBwYXJjZWwucGFyY2VsLnBhcmNlbElkID09PSBOdW1iZXIocmVxLnBhcmFtcy5wYXJjZWxJZCksXG4gICk7XG5cbiAgaWYgKHBhcmNlbERlbGl2ZXJ5Lmxlbmd0aCA+IDApIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG1lc3NhZ2U6IGBQYXJjZWwgb2YgaWQgJHtyZXEucGFyYW1zLnBhcmNlbElkfSByZXRyaWV2ZWQgc3VjY2Vzc2Z1bGx5YCxcbiAgICAgIHBhcmNlbDogcGFyY2VsRGVsaXZlcnlbMF0sXG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHtcbiAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICBtZXNzYWdlOiBgUGFyY2VsIG9mIGlkICR7cmVxLnBhcmFtcy5wYXJjZWxJZH0gZG9lcyBub3QgZXhpc3RgLFxuICB9KTtcbn0pO1xuXG4vLyBDYW5jZWwgYSBwYXJjZWwgZGVsaXZlcnkgb3JkZXJcbnJvdXRlci5wdXQoJy86cGFyY2VsSWQvY2FuY2VsJywgKHJlcSwgcmVzKSA9PiB7XG4gIGxldCBwYXJjZWxEZWxpdmVyeSA9IHt9O1xuICBsZXQgaW5kZXg7XG4gIHJlcS5wYXJhbXMucGFyY2VsSWQgPSBOdW1iZXIocmVxLnBhcmFtcy5wYXJjZWxJZCk7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgUGFyY2Vscy5sZW5ndGg7IGkgKz0gMSkge1xuICAgIGlmIChQYXJjZWxzW2ldLnBhcmNlbC5wYXJjZWxJZCA9PT0gcmVxLnBhcmFtcy5wYXJjZWxJZCkge1xuICAgICAgcGFyY2VsRGVsaXZlcnkgPSBQYXJjZWxzW2ldLnBhcmNlbDtcbiAgICAgIGluZGV4ID0gaTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIGlmIChwYXJjZWxEZWxpdmVyeSkge1xuICAgIGlmIChcbiAgICAgIHBhcmNlbERlbGl2ZXJ5LnN0YXR1cyA9PT0gJ3BlbmRpbmcnIHx8IHBhcmNlbERlbGl2ZXJ5LnN0YXR1cyA9PT0gJ2NhbmNlbGVkJ1xuICAgICkge1xuICAgICAgcGFyY2VsRGVsaXZlcnkuc3RhdHVzID0gJ2NhbmNlbGVkJztcbiAgICAgIGlmIChQYXJjZWxzW2luZGV4XS5wYXJjZWwucGFyY2VsSWQgPT09IHBhcmNlbERlbGl2ZXJ5LnBhcmNlbElkKSB7XG4gICAgICAgIFBhcmNlbHNbaW5kZXhdLnBhcmNlbC5zdGF0dXMgPSAnY2FuY2VsZWQnO1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLnNlbmQoe1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgbWVzc2FnZTogJ1BhcmNlbCBpcyBzdWNjZXNzZnVsbHkgY2FuY2VsZWQnLFxuICAgICAgICAgIHBhcmNlbDogcGFyY2VsRGVsaXZlcnksXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5zZW5kKHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIG1lc3NhZ2U6ICdEYXRhIGluZGV4IGNoYW5nZWQuIFRyeSBhZ2FpbiEnLFxuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuc2VuZCh7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIG1lc3NhZ2U6XG4gICAgICAgICdOb3QgYWxsb3dlZCB0byBjYW5jZWwgYSBwYXJjZWwgd2l0aCBzdGF0dXMgb2YgZGVsaXZlcmVkIG9yIHRyYW5zaXQnLFxuICAgIH0pO1xuICB9XG4gIHJldHVybiByZXMuc3RhdHVzKDQwNCkuc2VuZCh7XG4gICAgc3VjY2VzczogZmFsc2UsXG4gICAgbWVzc2FnZTogJ1BhcmNlbCBub3QgZm91bmQnLFxuICB9KTtcbn0pO1xuXG5leHBvcnQgZGVmYXVsdCByb3V0ZXI7XG4iXX0=