'use strict';var cov_vcspnr813=function(){var path="/home/emmanuel/Projects/SelfProject/sendit/src/routes/parcels.js",hash="9e01c48dbabe64f2c70516af5377cd91f3666261",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/home/emmanuel/Projects/SelfProject/sendit/src/routes/parcels.js",statementMap:{"0":{start:{line:3,column:0},end:{line:5,column:3}},"1":{start:{line:7,column:15},end:{line:7,column:33}},"2":{start:{line:9,column:16},end:{line:9,column:48}},"3":{start:{line:11,column:15},end:{line:11,column:41}},"4":{start:{line:13,column:16},end:{line:13,column:48}},"5":{start:{line:15,column:13},end:{line:15,column:37}},"6":{start:{line:17,column:14},end:{line:17,column:44}},"7":{start:{line:19,column:39},end:{line:19,column:93}},"8":{start:{line:21,column:35},end:{line:21,column:193}},"9":{start:{line:21,column:61},end:{line:21,column:145}},"10":{start:{line:21,column:126},end:{line:21,column:143}},"11":{start:{line:21,column:146},end:{line:21,column:158}},"12":{start:{line:21,column:168},end:{line:21,column:191}},"13":{start:{line:23,column:13},end:{line:23,column:39}},"14":{start:{line:26,column:0},end:{line:66,column:3}},"15":{start:{line:28,column:20},end:{line:28,column:22}},"16":{start:{line:29,column:21},end:{line:29,column:23}},"17":{start:{line:31,column:14},end:{line:31,column:20}},"18":{start:{line:33,column:13},end:{line:35,column:7}},"19":{start:{line:34,column:4},end:{line:34,column:47}},"20":{start:{line:37,column:23},end:{line:39,column:3}},"21":{start:{line:38,column:4},end:{line:38,column:83}},"22":{start:{line:40,column:2},end:{line:60,column:3}},"23":{start:{line:43,column:4},end:{line:43,column:109}},"24":{start:{line:45,column:14},end:{line:45,column:42}},"25":{start:{line:46,column:21},end:{line:46,column:48}},"26":{start:{line:47,column:4},end:{line:47,column:30}},"27":{start:{line:48,column:4},end:{line:48,column:34}},"28":{start:{line:51,column:4},end:{line:51,column:39}},"29":{start:{line:53,column:4},end:{line:53,column:35}},"30":{start:{line:54,column:4},end:{line:59,column:7}},"31":{start:{line:62,column:2},end:{line:65,column:5}},"32":{start:{line:69,column:0},end:{line:76,column:3}},"33":{start:{line:70,column:25},end:{line:70,column:73}},"34":{start:{line:71,column:2},end:{line:75,column:5}},"35":{start:{line:79,column:0},end:{line:95,column:3}},"36":{start:{line:80,column:23},end:{line:82,column:4}},"37":{start:{line:81,column:4},end:{line:81,column:66}},"38":{start:{line:84,column:2},end:{line:90,column:3}},"39":{start:{line:85,column:4},end:{line:89,column:7}},"40":{start:{line:91,column:2},end:{line:94,column:5}},"41":{start:{line:98,column:0},end:{line:144,column:3}},"42":{start:{line:99,column:15},end:{line:101,column:4}},"43":{start:{line:100,column:4},end:{line:100,column:49}},"44":{start:{line:102,column:14},end:{line:102,column:47}},"45":{start:{line:103,column:2},end:{line:110,column:3}},"46":{start:{line:104,column:4},end:{line:104,column:48}},"47":{start:{line:105,column:4},end:{line:109,column:7}},"48":{start:{line:111,column:2},end:{line:114,column:5}},"49":{start:{line:146,column:0},end:{line:146,column:25}}},fnMap:{"0":{name:"_interopRequireDefault",decl:{start:{line:19,column:9},end:{line:19,column:31}},loc:{start:{line:19,column:37},end:{line:19,column:95}},line:19},"1":{name:"_toConsumableArray",decl:{start:{line:21,column:9},end:{line:21,column:27}},loc:{start:{line:21,column:33},end:{line:21,column:195}},line:21},"2":{name:"(anonymous_2)",decl:{start:{line:26,column:17},end:{line:26,column:18}},loc:{start:{line:26,column:37},end:{line:66,column:1}},line:26},"3":{name:"(anonymous_3)",decl:{start:{line:33,column:36},end:{line:33,column:37}},loc:{start:{line:33,column:56},end:{line:35,column:3}},line:33},"4":{name:"calculatePrice",decl:{start:{line:37,column:32},end:{line:37,column:46}},loc:{start:{line:37,column:66},end:{line:39,column:3}},line:37},"5":{name:"(anonymous_5)",decl:{start:{line:69,column:16},end:{line:69,column:17}},loc:{start:{line:69,column:36},end:{line:76,column:1}},line:69},"6":{name:"(anonymous_6)",decl:{start:{line:79,column:25},end:{line:79,column:26}},loc:{start:{line:79,column:45},end:{line:95,column:1}},line:79},"7":{name:"(anonymous_7)",decl:{start:{line:80,column:48},end:{line:80,column:49}},loc:{start:{line:80,column:66},end:{line:82,column:3}},line:80},"8":{name:"(anonymous_8)",decl:{start:{line:98,column:32},end:{line:98,column:33}},loc:{start:{line:98,column:52},end:{line:144,column:1}},line:98},"9":{name:"(anonymous_9)",decl:{start:{line:99,column:38},end:{line:99,column:39}},loc:{start:{line:99,column:54},end:{line:101,column:3}},line:99}},branchMap:{"0":{loc:{start:{line:19,column:46},end:{line:19,column:92}},type:"cond-expr",locations:[{start:{line:19,column:70},end:{line:19,column:73}},{start:{line:19,column:76},end:{line:19,column:92}}],line:19},"1":{loc:{start:{line:19,column:46},end:{line:19,column:67}},type:"binary-expr",locations:[{start:{line:19,column:46},end:{line:19,column:49}},{start:{line:19,column:53},end:{line:19,column:67}}],line:19},"2":{loc:{start:{line:21,column:35},end:{line:21,column:193}},type:"if",locations:[{start:{line:21,column:35},end:{line:21,column:193}},{start:{line:21,column:35},end:{line:21,column:193}}],line:21},"3":{loc:{start:{line:40,column:2},end:{line:60,column:3}},type:"if",locations:[{start:{line:40,column:2},end:{line:60,column:3}},{start:{line:40,column:2},end:{line:60,column:3}}],line:40},"4":{loc:{start:{line:43,column:12},end:{line:43,column:108}},type:"cond-expr",locations:[{start:{line:43,column:50},end:{line:43,column:77}},{start:{line:43,column:80},end:{line:43,column:108}}],line:43},"5":{loc:{start:{line:84,column:2},end:{line:90,column:3}},type:"if",locations:[{start:{line:84,column:2},end:{line:90,column:3}},{start:{line:84,column:2},end:{line:90,column:3}}],line:84},"6":{loc:{start:{line:103,column:2},end:{line:110,column:3}},type:"if",locations:[{start:{line:103,column:2},end:{line:110,column:3}},{start:{line:103,column:2},end:{line:110,column:3}}],line:103},"7":{loc:{start:{line:103,column:6},end:{line:103,column:52}},type:"binary-expr",locations:[{start:{line:103,column:6},end:{line:103,column:16}},{start:{line:103,column:20},end:{line:103,column:52}}],line:103}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();cov_vcspnr813.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});var _express=(cov_vcspnr813.s[1]++,require('express'));var _express2=(cov_vcspnr813.s[2]++,_interopRequireDefault(_express));var _parcels=(cov_vcspnr813.s[3]++,require('../data/parcels'));var _parcels2=(cov_vcspnr813.s[4]++,_interopRequireDefault(_parcels));var _users=(cov_vcspnr813.s[5]++,require('../data/users'));var _users2=(cov_vcspnr813.s[6]++,_interopRequireDefault(_users));function _interopRequireDefault(obj){cov_vcspnr813.f[0]++;cov_vcspnr813.s[7]++;return(cov_vcspnr813.b[1][0]++,obj)&&(cov_vcspnr813.b[1][1]++,obj.__esModule)?(cov_vcspnr813.b[0][0]++,obj):(cov_vcspnr813.b[0][1]++,{default:obj});}function _toConsumableArray(arr){cov_vcspnr813.f[1]++;cov_vcspnr813.s[8]++;if(Array.isArray(arr)){cov_vcspnr813.b[2][0]++;cov_vcspnr813.s[9]++;for(var i=0,arr2=Array(arr.length);i<arr.length;i++){cov_vcspnr813.s[10]++;arr2[i]=arr[i];}cov_vcspnr813.s[11]++;return arr2;}else{cov_vcspnr813.b[2][1]++;cov_vcspnr813.s[12]++;return Array.from(arr);}}var router=(cov_vcspnr813.s[13]++,_express2.default.Router());// Create parcel
cov_vcspnr813.s[14]++;router.post('/',function(req,res){cov_vcspnr813.f[2]++;// const { userId } = req.body;
var priceNormal=(cov_vcspnr813.s[15]++,20);// Price in $
var priceExpress=(cov_vcspnr813.s[16]++,70);// Parcel price in $
var price=(cov_vcspnr813.s[17]++,void 0);var user=(cov_vcspnr813.s[18]++,_users2.default.filter(function(customer){cov_vcspnr813.f[3]++;cov_vcspnr813.s[19]++;return customer.userId===req.body.userId;})[0]);cov_vcspnr813.s[20]++;var calculatePrice=function calculatePrice(pricePerOneWeight){cov_vcspnr813.f[4]++;cov_vcspnr813.s[21]++;return pricePerOneWeight*req.body.weight*req.body.height*req.body.length;};cov_vcspnr813.s[22]++;if(user){cov_vcspnr813.b[3][0]++;cov_vcspnr813.s[23]++;// Price per Service on Normal
// Price per Service on Express
price=req.body.From===req.body.services?(cov_vcspnr813.b[4][0]++,calculatePrice(priceNormal)):(cov_vcspnr813.b[4][1]++,calculatePrice(priceExpress));// Parcel Id
var pId=(cov_vcspnr813.s[24]++,_parcels2.default.length+1);var parcelWith=(cov_vcspnr813.s[25]++,Object.assign({},req.body));cov_vcspnr813.s[26]++;parcelWith.parcelId=pId;cov_vcspnr813.s[27]++;parcelWith.status='Pending';// Save parcel
cov_vcspnr813.s[28]++;_parcels2.default.push(parcelWith);cov_vcspnr813.s[29]++;console.log(_parcels2.default);cov_vcspnr813.s[30]++;return res.status(201).json({success:true,message:'Parcel created successfully',parcelId:pId,price:Number(price.toFixed(2))});}else{cov_vcspnr813.b[3][1]++;}cov_vcspnr813.s[31]++;return res.status(404).json({success:false,message:'User not Exist'});});// Get all parcels
cov_vcspnr813.s[32]++;router.get('/',function(req,res){cov_vcspnr813.f[5]++;var parcelDeliveries=(cov_vcspnr813.s[33]++,[].concat(_toConsumableArray(_parcels2.default)));cov_vcspnr813.s[34]++;res.status(200).json({success:true,message:'Parcels retrieved successfully',parcels:parcelDeliveries});});// Get a specific parcels
cov_vcspnr813.s[35]++;router.get('/:parcelId',function(req,res){cov_vcspnr813.f[6]++;var parcelDelivery=(cov_vcspnr813.s[36]++,_parcels2.default.filter(function(parcel){cov_vcspnr813.f[7]++;cov_vcspnr813.s[37]++;return parcel.parcel.parcelId===Number(req.params.parcelId);}));cov_vcspnr813.s[38]++;if(parcelDelivery.length>0){cov_vcspnr813.b[5][0]++;cov_vcspnr813.s[39]++;return res.status(200).json({success:true,message:'Parcel of id '+req.params.parcelId+' retrieved successfully',parcel:parcelDelivery[0]});}else{cov_vcspnr813.b[5][1]++;}cov_vcspnr813.s[40]++;return res.status(404).json({success:false,message:'Parcel of id '+req.params.parcelId+' does not exist'});});// Cancel a parcel delivery order
cov_vcspnr813.s[41]++;router.put('/:parcelId/cancel',function(req,res){cov_vcspnr813.f[8]++;var parcel=(cov_vcspnr813.s[42]++,_parcels2.default.find(function(item){cov_vcspnr813.f[9]++;cov_vcspnr813.s[43]++;return item.parcelId===req.params.parcelId;}));var index=(cov_vcspnr813.s[44]++,_parcels2.default.indexOf(parcel));cov_vcspnr813.s[45]++;if((cov_vcspnr813.b[7][0]++,index>=0)&&(cov_vcspnr813.b[7][1]++,index<_parcels2.default.length)){cov_vcspnr813.b[6][0]++;cov_vcspnr813.s[46]++;_parcels2.default[index].status='pending';cov_vcspnr813.s[47]++;return res.status(200).send({success:true,message:'Parcel is successfully canceled',parcel:index});}else{cov_vcspnr813.b[6][1]++;}cov_vcspnr813.s[48]++;return res.status(405).send({success:false,message:'Not allowed to cancel a parcel with status of delivered or transit'});// if (parcelDelivery) {
//   if (
//     parcelDelivery.status === 'pending' || parcelDelivery.status === 'canceled'
//   ) {
//     parcelDelivery.status = 'canceled';
//     if (Parcels[index].parcel.parcelId === parcelDelivery.parcelId) {
//       Parcels[index].parcel.status = 'canceled';
//       return res.status(200).send({
//         success: true,
//         message: 'Parcel is successfully canceled',
//         parcel: parcelDelivery,
//       });
//     }
//     return res.status(405).send({
//       success: false,
//       message: 'Data index changed. Try again!',
//     });
//   }
//   return res.status(405).send({
//     success: false,
//     message:
//       'Not allowed to cancel a parcel with status of delivered or transit',
//   });
// }
// return res.status(404).send({
//   success: false,
//   message: 'Parcel not found',
// });
});cov_vcspnr813.s[49]++;exports.default=router;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBhcmNlbHMuanMiXSwibmFtZXMiOlsicm91dGVyIiwiZXhwcmVzcyIsIlJvdXRlciIsInBvc3QiLCJyZXEiLCJyZXMiLCJwcmljZU5vcm1hbCIsInByaWNlRXhwcmVzcyIsInByaWNlIiwidXNlciIsIlVzZXIiLCJmaWx0ZXIiLCJjdXN0b21lciIsInVzZXJJZCIsImJvZHkiLCJjYWxjdWxhdGVQcmljZSIsInByaWNlUGVyT25lV2VpZ2h0Iiwid2VpZ2h0IiwiaGVpZ2h0IiwibGVuZ3RoIiwiRnJvbSIsInNlcnZpY2VzIiwicElkIiwiUGFyY2VscyIsInBhcmNlbFdpdGgiLCJwYXJjZWxJZCIsInN0YXR1cyIsInB1c2giLCJjb25zb2xlIiwibG9nIiwianNvbiIsInN1Y2Nlc3MiLCJtZXNzYWdlIiwiTnVtYmVyIiwidG9GaXhlZCIsImdldCIsInBhcmNlbERlbGl2ZXJpZXMiLCJwYXJjZWxzIiwicGFyY2VsRGVsaXZlcnkiLCJwYXJjZWwiLCJwYXJhbXMiLCJwdXQiLCJmaW5kIiwiaXRlbSIsImluZGV4IiwiaW5kZXhPZiIsInNlbmQiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBOzs7O0FBQ0E7Ozs7QUFDQTs7Ozs7Ozs7QUFFQSxJQUFNQSxTQUFTQyxrQkFBUUMsTUFBUixFQUFmOztBQUVBO0FBQ0FGLE9BQU9HLElBQVAsQ0FBWSxHQUFaLEVBQWlCLFVBQUNDLEdBQUQsRUFBTUMsR0FBTixFQUFjO0FBQzdCO0FBQ0EsTUFBTUMsY0FBYyxFQUFwQixDQUY2QixDQUVMO0FBQ3hCLE1BQU1DLGVBQWUsRUFBckI7QUFDQTtBQUNBLE1BQUlDLGNBQUo7O0FBRUEsTUFBTUMsT0FBT0MsZ0JBQUtDLE1BQUwsQ0FBWTtBQUFBLFdBQVlDLFNBQVNDLE1BQVQsS0FBb0JULElBQUlVLElBQUosQ0FBU0QsTUFBekM7QUFBQSxHQUFaLEVBQTZELENBQTdELENBQWI7O0FBRUEsTUFBTUUsaUJBQWlCLFNBQWpCQSxjQUFpQjtBQUFBLFdBQ3BCQyxvQkFBb0JaLElBQUlVLElB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LE1BQWYsR0FBd0IsU0FBeEI7QUFDQSxXQUFPckIsSUFBSXFCLE1BQUosQ0FBVyxHQUFYLEVBQWdCb0IsSUFBaEIsQ0FBcUI7QUFDMUJmLGVBQVMsSUFEaUI7QUFFMUJDLGVBQVMsaUNBRmlCO0FBRzFCTyxjQUFRSztBQUhrQixLQUFyQixDQUFQO0FBS0Q7QUFDRCxTQUFPdkMsSUFBSXFCLE1BQUosQ0FBVyxHQUFYLEVBQWdCb0IsSUFBaEIsQ0FBcUI7QUFDMUJmLGFBQVMsS0FEaUI7QUFFMUJDLGFBQVM7QUFGaUIsR0FBckIsQ0FBUDs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNELENBNUNEOztrQkE4Q2VoQyxNIiwiZmlsZSI6InBhcmNlbHMuanMiLCJzb3VyY2VSb290IjoiL2hvbWUvZW1tYW51ZWwvUHJvamVjdHMvU2VsZlByb2plY3Qvc2VuZGl0L3NyYy9yb3V0ZXMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZXhwcmVzcyBmcm9tICdleHByZXNzJztcbmltcG9ydCBQYXJjZWxzIGZyb20gJy4uL2RhdGEvcGFyY2Vscyc7XG5pbXBvcnQgVXNlciBmcm9tICcuLi9kYXRhL3VzZXJzJztcblxuY29uc3Qgcm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTtcblxuLy8gQ3JlYXRlIHBhcmNlbFxucm91dGVyLnBvc3QoJy8nLCAocmVxLCByZXMpID0+IHtcbiAgLy8gY29uc3QgeyB1c2VySWQgfSA9IHJlcS5ib2R5O1xuICBjb25zdCBwcmljZU5vcm1hbCA9IDIwOyAvLyBQcmljZSBpbiAkXG4gIGNvbnN0IHByaWNlRXhwcmVzcyA9IDcwO1xuICAvLyBQYXJjZWwgcHJpY2UgaW4gJFxuICBsZXQgcHJpY2U7XG5cbiAgY29uc3QgdXNlciA9IFVzZXIuZmlsdGVyKGN1c3RvbWVyID0+IGN1c3RvbWVyLnVzZXJJZCA9PT0gcmVxLmJvZHkudXNlcklkKVswXTtcblxuICBjb25zdCBjYWxjdWxhdGVQcmljZSA9IHByaWNlUGVyT25lV2VpZ2h0ID0+IChcbiAgICAocHJpY2VQZXJPbmVXZWlnaHQgKiByZXEuYm9keS53ZWlnaHQgKiByZXEuYm9keS5oZWlnaHQgKiByZXEuYm9keS5sZW5ndGgpXG4gICk7XG4gIGlmICh1c2VyKSB7XG4gICAgLy8gUHJpY2UgcGVyIFNlcnZpY2Ugb24gTm9ybWFsXG4gICAgLy8gUHJpY2UgcGVyIFNlcnZpY2Ugb24gRXhwcmVzc1xuICAgIHByaWNlID0gcmVxLmJvZHkuRnJvbSA9PT0gcmVxLmJvZHkuc2VydmljZXNcbiAgICAgID8gY2FsY3VsYXRlUHJpY2UocHJpY2VOb3JtYWwpXG4gICAgICA6IGNhbGN1bGF0ZVByaWNlKHByaWNlRXhwcmVzcyk7XG4gICAgLy8gUGFyY2VsIElkXG4gICAgY29uc3QgcElkID0gUGFyY2Vscy5sZW5ndGggKyAxO1xuICAgIGNvbnN0IHBhcmNlbFdpdGggPSB7IC4uLnJlcS5ib2R5IH07XG4gICAgcGFyY2VsV2l0aC5wYXJjZWxJZCA9IHBJZDtcbiAgICBwYXJjZWxXaXRoLnN0YXR1cyA9ICdQZW5kaW5nJztcblxuICAgIC8vIFNhdmUgcGFyY2VsXG4gICAgUGFyY2Vscy5wdXNoKHBhcmNlbFdpdGgpO1xuXG4gICAgY29uc29sZS5sb2coUGFyY2Vscyk7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAxKS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBtZXNzYWdlOiAnUGFyY2VsIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgICAgIHBhcmNlbElkOiBwSWQsXG4gICAgICBwcmljZTogTnVtYmVyKHByaWNlLnRvRml4ZWQoMikpLFxuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHtcbiAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICBtZXNzYWdlOiAnVXNlciBub3QgRXhpc3QnLFxuICB9KTtcbn0pO1xuXG4vLyBHZXQgYWxsIHBhcmNlbHNcbnJvdXRlci5nZXQoJy8nLCAocmVxLCByZXMpID0+IHtcbiAgY29uc3QgcGFyY2VsRGVsaXZlcmllcyA9IFsuLi5QYXJjZWxzXTtcbiAgcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgbWVzc2FnZTogJ1BhcmNlbHMgcmV0cmlldmVkIHN1Y2Nlc3NmdWxseScsXG4gICAgcGFyY2VsczogcGFyY2VsRGVsaXZlcmllcyxcbiAgfSk7XG59KTtcblxuLy8gR2V0IGEgc3BlY2lmaWMgcGFyY2Vsc1xucm91dGVyLmdldCgnLzpwYXJjZWxJZCcsIChyZXEsIHJlcykgPT4ge1xuICBjb25zdCBwYXJjZWxEZWxpdmVyeSA9IFBhcmNlbHMuZmlsdGVyKFxuICAgIHBhcmNlbCA9PiBwYXJjZWwucGFyY2VsLnBhcmNlbElkID09PSBOdW1iZXIocmVxLnBhcmFtcy5wYXJjZWxJZCksXG4gICk7XG5cbiAgaWYgKHBhcmNlbERlbGl2ZXJ5Lmxlbmd0aCA+IDApIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG1lc3NhZ2U6IGBQYXJjZWwgb2YgaWQgJHtyZXEucGFyYW1zLnBhcmNlbElkfSByZXRyaWV2ZWQgc3VjY2Vzc2Z1bGx5YCxcbiAgICAgIHBhcmNlbDogcGFyY2VsRGVsaXZlcnlbMF0sXG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHtcbiAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICBtZXNzYWdlOiBgUGFyY2VsIG9mIGlkICR7cmVxLnBhcmFtcy5wYXJjZWxJZH0gZG9lcyBub3QgZXhpc3RgLFxuICB9KTtcbn0pO1xuXG4vLyBDYW5jZWwgYSBwYXJjZWwgZGVsaXZlcnkgb3JkZXJcbnJvdXRlci5wdXQoJy86cGFyY2VsSWQvY2FuY2VsJywgKHJlcSwgcmVzKSA9PiB7XG4gIGNvbnN0IHBhcmNlbCA9IFBhcmNlbHMuZmluZChpdGVtID0+IGl0ZW0ucGFyY2VsSWQgPT09IHJlcS5wYXJhbXMucGFyY2VsSWQpO1xuICBsZXQgaW5kZXggPSBQYXJjZWxzLmluZGV4T2YocGFyY2VsKTtcbiAgaWYgKGluZGV4ID49IDAgJiYgaW5kZXggPCBQYXJjZWxzLmxlbmd0aCkge1xuICAgIFBhcmNlbHNbaW5kZXhdLnN0YXR1cyA9ICdwZW5kaW5nJztcbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLnNlbmQoe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG1lc3NhZ2U6ICdQYXJjZWwgaXMgc3VjY2Vzc2Z1bGx5IGNhbmNlbGVkJyxcbiAgICAgIHBhcmNlbDogaW5kZXgsXG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5zZW5kKHtcbiAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICBtZXNzYWdlOiAnTm90IGFsbG93ZWQgdG8gY2FuY2VsIGEgcGFyY2VsIHdpdGggc3RhdHVzIG9mIGRlbGl2ZXJlZCBvciB0cmFuc2l0JyxcbiAgfSk7XG5cbiAgLy8gaWYgKHBhcmNlbERlbGl2ZXJ5KSB7XG4gIC8vICAgaWYgKFxuICAvLyAgICAgcGFyY2VsRGVsaXZlcnkuc3RhdHVzID09PSAncGVuZGluZycgfHwgcGFyY2VsRGVsaXZlcnkuc3RhdHVzID09PSAnY2FuY2VsZWQnXG4gIC8vICAgKSB7XG4gIC8vICAgICBwYXJjZWxEZWxpdmVyeS5zdGF0dXMgPSAnY2FuY2VsZWQnO1xuICAvLyAgICAgaWYgKFBhcmNlbHNbaW5kZXhdLnBhcmNlbC5wYXJjZWxJZCA9PT0gcGFyY2VsRGVsaXZlcnkucGFyY2VsSWQpIHtcbiAgLy8gICAgICAgUGFyY2Vsc1tpbmRleF0ucGFyY2VsLnN0YXR1cyA9ICdjYW5jZWxlZCc7XG4gIC8vICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuc2VuZCh7XG4gIC8vICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgLy8gICAgICAgICBtZXNzYWdlOiAnUGFyY2VsIGlzIHN1Y2Nlc3NmdWxseSBjYW5jZWxlZCcsXG4gIC8vICAgICAgICAgcGFyY2VsOiBwYXJjZWxEZWxpdmVyeSxcbiAgLy8gICAgICAgfSk7XG4gIC8vICAgICB9XG4gIC8vICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLnNlbmQoe1xuICAvLyAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgLy8gICAgICAgbWVzc2FnZTogJ0RhdGEgaW5kZXggY2hhbmdlZC4gVHJ5IGFnYWluIScsXG4gIC8vICAgICB9KTtcbiAgLy8gICB9XG4gIC8vICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5zZW5kKHtcbiAgLy8gICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAvLyAgICAgbWVzc2FnZTpcbiAgLy8gICAgICAgJ05vdCBhbGxvd2VkIHRvIGNhbmNlbCBhIHBhcmNlbCB3aXRoIHN0YXR1cyBvZiBkZWxpdmVyZWQgb3IgdHJhbnNpdCcsXG4gIC8vICAgfSk7XG4gIC8vIH1cbiAgLy8gcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5zZW5kKHtcbiAgLy8gICBzdWNjZXNzOiBmYWxzZSxcbiAgLy8gICBtZXNzYWdlOiAnUGFyY2VsIG5vdCBmb3VuZCcsXG4gIC8vIH0pO1xufSk7XG5cbmV4cG9ydCBkZWZhdWx0IHJvdXRlcjtcbiJdfQ==